# 订阅消息申请与云函数部署指南 (2026-02-02)

## 一、 申请订阅消息模板 ID

1.  **登录后台**：进入 [微信公众平台 (小程序管理后台)](https://mp.weixin.qq.com/)。
2.  **进入功能页**：左侧菜单栏选择 **“设置” -> “订阅消息”**。
3.  **添加模板**：
    *   点击 **“公共模板库”**，搜索相关关键词（如“任务”、“提醒”、“礼品”）。
    *   **选择字段**：根据项目占位设计，请务必包含以下类似字段：
        *   `thing.DATA` (对应任务/礼品名)
        *   `name.DATA` (对应操作人)
        *   `time.DATA` (对应时间)
        *   `phrase.DATA` (对应状态，如“已完成”)
4.  **获取 ID**：申请成功后，在“我的模板”列表中复制以 `T...` 开头的 **模板 ID**。
5.  **代码替换**：将获取到的 ID 填写到项目中的 `src/utils/subscribe.ts` 文件内对应的常量位置。

---

## 二、 云函数上传与部署 (推荐方法)

由于修改了 `addTask`、`updateTaskStatus` 和 `useItem` 三个云函数的逻辑及权限配置，请按以下步骤操作：

1.  **打开项目**：在 **微信开发者工具** 中打开当前项目。
2.  **找到目录**：在左侧文件树中找到 `cloudfunctions` 文件夹。
3.  **执行部署**：
    *   分别右键点击 `addTask`、`updateTaskStatus` 和 `useItem` 这三个文件夹。
    *   选择 **“上传并部署：所有文件”**。
4.  **验证权限**：部署完成后，开发者工具控制台会自动将本地的 `config.json` 权限同步至云端。

---

## 三、 关键核对清单 (Checklist)

*   **[ ] 权限确认**：检查部署后的云函数后台，确认“权限设置”中已包含 `subscribeMessage.send`。
*   **[ ] 字段匹配**：确认你在后台申请的模板字段名称（如 `thing1`, `name2`）与代码中调用的 Key 保持一致。
*   **[ ] 环境一致性**：确保部署的云环境 ID 与前端初始化的环境一致。

---
*Generated by Claude Code - 理物极简风开发指南*
