@import "../../styles/theme.scss";

// 强制触发重新编译
// 兑换历史底部弹窗
.history-sheet-root {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10rpx);
  z-index: 2100;
  display: flex;
  flex-direction: column;
  justify-content: flex-end;

  .history-sheet-content {
    width: 100%;
    background: #FFFFFF;
    border-top-left-radius: 60rpx;
    border-top-right-radius: 60rpx;
    display: flex;
    flex-direction: column;
    animation: sheet-slide-up 0.4s cubic-bezier(0.23, 1, 0.32, 1);
    box-shadow: 0 -20rpx 60rpx rgba(0, 0, 0, 0.1);
    max-height: calc(90vh - env(safe-area-inset-top));

    .sheet-header {
      padding: 64rpx 48rpx 32rpx; // 增加顶部内边距，使标题下沉，不贴顶
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;

      .title {
        font-size: 38rpx; // 略微调大标题
        font-weight: 900;
        color: $text-main;
        letter-spacing: 2rpx;
      }

      .close {
        font-size: 52rpx;
        color: #CCC; // 颜色调淡
        padding: 10rpx;
        margin-right: -10rpx; // 视觉修正，使关闭按钮对齐边缘
      }
    }

    .sheet-tabs {
      display: flex;
      margin: 0 48rpx 24rpx; // 调整间距
      padding: 8rpx;
      background: #F2F2F2; // 稍微加深轨道颜色增加对比
      border-radius: 100rpx;
      flex-shrink: 0;

      .tab {
        flex: 1;
        padding: 18rpx 0; // 增加高度
        text-align: center;
        font-size: 28rpx; // 调大字体
        color: #999;
        border-radius: 100rpx;
        font-weight: 600;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        border: none;
        background: transparent;

        &.active {
          background: $secondary-color;
          color: #fff;
          font-weight: bold;
          box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.12);
        }
      }
    }

    .history-scroll {
      flex: 1;
      height: 0;
      width: 100%;
      padding: 0; // 移除父级 padding，让子元素控制宽度
      min-height: 50vh;

      .empty-history {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        // 垂直居中参考：底部留出 TabBar 的高度，使内容中心位于 [Tabs底部] 到 [TabBar顶部] 的中间
        padding-bottom: calc(140rpx + env(safe-area-inset-bottom));
        box-sizing: border-box;

        .empty-icon {
          font-size: 96rpx;
          opacity: 0.15;
          margin-bottom: 32rpx;
          filter: grayscale(100%);
        }

        .empty-text {
          font-size: 28rpx;
          color: #B0B0B0;
          letter-spacing: 2rpx;
          font-weight: 500;
        }
      }

      .history-list {
        // 列表内容独立控制内边距：左右 48rpx，底部避开 TabBar
        padding: 0 48rpx calc(140rpx + env(safe-area-inset-bottom));

        .history-item {
          display: flex;
          align-items: center;
          padding: 32rpx 0; // 增加列表项间距
          border-bottom: 1rpx solid rgba(0, 0, 0, 0.03); // 极细分割线

          &.deleted {
            opacity: 0.5;
            filter: grayscale(100%);
          }

          .item-left {
            margin-right: 24rpx;

            .item-image {
              width: 96rpx; // 增大图片尺寸
              height: 96rpx;
              border-radius: 24rpx;
              background: #F8F8F8;
              border: 1rpx solid rgba(0, 0, 0, 0.03);
            }

            .item-placeholder {
              width: 96rpx;
              height: 96rpx;
              border-radius: 24rpx;
              background: #F8F8F8;
              @include flex-center;
              font-size: 40rpx;
              color: #DDD;
            }
          }

          .item-center {
            flex: 1;
            padding-right: 20rpx;

            .item-name {
              font-size: 30rpx; // 调大标题
              font-weight: 600;
              color: $text-main;
              margin-bottom: 8rpx;
            }

            .item-points {
              font-size: 24rpx;
              color: #999; // 次要信息改灰
              font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; // 数字使用等宽字体
            }
          }

          .item-status {
            padding: 8rpx 24rpx;
            border-radius: 24rpx;
            font-size: 22rpx;
            font-weight: 600;
            letter-spacing: 1rpx;

            &.unused {
              background: rgba($primary-color, 0.1); // 使用主题色
              color: $primary-color;
            }

            &.used {
              background: #F5F5F5;
              color: #CCC;
            }
          }
        }

        .loading-more,
        .no-more {
          text-align: center;
          padding: 30rpx 0;
          color: #999;
          font-size: 24rpx;
        }
      }
    }
  }
}

@keyframes sheet-slide-up {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}
